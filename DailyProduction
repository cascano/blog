Sub DailyProduction()
'
' DailyProduction Macro
' Daily Production numbers for AMU2
'
' Keyboard Shortcut: Ctrl+Shift+Y
'

    'select and past title row in new sheet
    Sheets("Day").Select
    Rows("1:2").Select
    Selection.Copy
    Sheets.Add After:=Sheets(Sheets.Count)
    ActiveSheet.Paste
    
    
    'Get P150_AMU2 row number
    Sheets("Day").Select
    Range("A1").Select
    Cells.Find(What:="P150_AMU2", After:=ActiveCell, LookIn:=xlFormulas, _
        LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
        MatchCase:=False, SearchFormat:=False).Activate
    Dim TargetRow_1 As Integer
    TargetRow_1 = ActiveCell.Row
    
    'Get P150_AMU3 row number
    Sheets("Day").Select
    Range("A1").Select
    Cells.Find(What:="P150_AMU3", After:=ActiveCell, LookIn:=xlFormulas, _
        LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
        MatchCase:=False, SearchFormat:=False).Activate
    Dim TargetRow_2 As Integer
    TargetRow_2 = ActiveCell.Row
    
    
    'Select AMU2 row values and past in previously created sheet
    Let Copyrange = TargetRow_1 & ":" & TargetRow_2 - 1
    Rows(Copyrange).Select
    Selection.Copy
    Sheets(Sheets.Count).Select
    Range("A3").Select
    ActiveSheet.Paste
    Columns("A:T").Select
    Selection.Columns.AutoFit
    
    
    
    'find all numbers of AMU2 and past in previously created sheet
    'Sheets("Day").Select
    'Range("A1").Select
    'Cells.Find(What:="P150_AMU2", After:=ActiveCell, LookIn:=xlFormulas, _
        LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
        MatchCase:=False, SearchFormat:=False).Activate
    'Range(Selection, Selection.End(xlDown)).Select
    'Range(Selection, Selection.End(xlToRight)).Select
    'Selection.Copy
    'Sheets(Sheets.Count).Select
    'Range("A2").Select
    'ActiveSheet.Paste
    'Columns("A:W").Select
    'Selection.Columns.AutoFit
    
    'delete AMU3 last row from data
    'Range("A2").Select
    'Selection.End(xlDown).Select
    'Range(Selection, Selection.End(xlToRight)).Select
    'Selection.ClearContents
    
    
    'keep OEE, First Choiche and Scrap data, delete all the rest
    Columns("L:Z").Select
    Selection.ClearContents
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    
    
    ''OEE''
    'turn cell in light green if above OEE value
    Columns("E:E").Select
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlGreater, _
        Formula1:="=$E2"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = 0.399945066682943
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    
    
    'turn cell in light red if below OEE value
    Columns("E:E").Select
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, _
        Formula1:="=$E2"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 8420607
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    
    
    ''Scrap''
    'turn cell in light green if below Scrap target value
    Columns("J:J").Select
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, _
        Formula1:="=$J2"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = 0.399945066682943
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    
    'turn cell in light red if above Scrap target value
    
    

    
    
    
End Sub
